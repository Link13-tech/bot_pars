
# Bot Pars - Telegram Bot для загрузки файлов и добавления сайтов для парсинга

## Описание
Этот Telegram-бот позволяет пользователям загружать Excel-файлы с данными о сайтах для парсинга. Файлы должны содержать информацию о названии сайта, ссылке на сайт и css_selector для извлечения данных о цене. Бот сохраняет эти данные в базе данных SQLite для последующей обработки.

## Структура проекта
```
Bot_pars\
├── .env                        # Файл с переменными окружения
├── .gitignore                  # Игнорируемые файлы для git
├── README.md                   # Этот файл
├── requirements.txt            # Файл с зависимостями
├── bot\
│   ├── bot.py                  # Основной файл бота
│   ├── downloads\              # Загруженные файлы
│   └── handlers\
│       ├── start.py            # Обработчик команды старта
│       ├── upload.py           # Обработчик загрузки файла
│       └── items.py            # Обработчик парсера
├── database\
│   ├── bot_data.sqlite3.1      # Локальная база данных SQLite
│   └── db.py                   # Модели и взаимодействие с базой данных
└── parser\
    └──parser.py                # Парсер средней цены
```

## Установка и запуск

### 1. Клонируйте репозиторий
```bash
git clone https://github.com/Link13-tech/Bot_pars.git
cd Bot_pars
```

### 2. Создайте и активируйте виртуальное окружение

Для использования requirements.txt:
```bash
pip install -r requirements.txt
```

### 3. Настройте переменные окружения
Создайте файл `.env` в корне проекта и добавьте необходимые данные, такие как ваш `TELEGRAM_API_TOKEN`. Пример:
```ini
TELEGRAM_API_TOKEN=your_telegram_bot_token_here
```

### 4. Запуск бота
Для запуска бота выполните:
```bash
python -m bot.bot

```

Бот будет ожидать команду `/start` и предложит пользователю прикрепить файл Excel для загрузки данных.

### 5. Формат Excel файла
Файл должен содержать следующие столбцы:
- `title`: Название товара
- `url`: Ссылка на сайт
- `css_selector`: элемент с ценой


### 6. Взаимодействие с ботом
1. Пользователь запускает бота и получает сообщение для загрузки файла.
2. После загрузки файла бот читает его с помощью библиотеки pandas, выводит данные в чат и сохраняет их в базу данных SQLite.
3. После ввода команды /items бот парсит средние цены товаров из базы

## Локальная база данных
Данные о загруженных зюзюбликах и сайтах сохраняются в базе данных SQLite (`database/bot_data.sqlite3.1`).

### Примечание:
- Файл с данными сохраняется в папке `bot/downloads/`.

## Зависимости
- Python 3.9+
- aiogram
- pandas
- sqlite3
- openpyxl
- aiohttp
- python-dotenv
- selenium
- undetected-chromedriver